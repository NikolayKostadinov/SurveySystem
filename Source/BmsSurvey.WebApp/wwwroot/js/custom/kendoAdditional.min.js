var kendoAdditional=function(){"use strict";function i(){return{factoryId:$("input[name=factories]").val()||$("input[name=factoriesD]").val()}}function r(n){n.html=n.html.replaceAll("&nbsp;&nbsp;&nbsp;&nbsp;","");n.html=n.html.replaceAll("&nbsp;&nbsp;&nbsp;","");n.html=n.html.replaceAll("&nbsp;&nbsp;","");n.html=n.html.replaceAll("&nbsp; &nbsp;","")}function u(){var n="",t,i;return $("#report-details").length&&(t=$("#report-details").data("kendoEditor"),i=t.value(),n=encodeURI(i)),{reportText:n}}function f(){var t=$("input[name=date]").data("kendoDatePicker"),r,n;if(t!==undefined)r=t.value();else return;n={date:r.toISOString(kendo.culture().name)};$.extend(n,i());$.extend(n,u());$.extend(n,sendAntiForgery());$.ajax({url:"SaveReport",type:"POST",data:n,success:function(n){var r=n.IsConfirmed,i,t;r===!0?(i="Вие променихте описанието на технологичният отчет успешно.",$("pre#succ-message").text(i),$("div#success-window").data("kendoWindow").open()):n.errors&&(t="",$.each(n.errors,function(n,i){"errors"in i&&$.each(i.errors,function(){t+=this+"\n"})}),$("pre#err-message").text(t),$("div#err-window").data("kendoWindow").open())},error:function(n){var t="",i=JSON.parse(n.responseText).data;$.each(i.errors,function(){t+=this+"\n"});$("pre#err-message").text(t);$("div#err-window").data("kendoWindow").open()}})}function t(n,t){var i=$(n);i&&i.kendoWindow({width:"650px",title:t,actions:["Close"],modal:!0,position:{top:"30%",left:"30%"},minHeight:100,maxHeight:350})}function e(n){var t={};return n=$.isArray(n)?n:[n],n.forEach(function(n,i){t["values["+i+"]"]=n}),t}function o(n,t,i){t=$.isArray(t)?t:[t];t.forEach(function(t,r){if($.isPlainObject(t)){var u=Object.keys(t);u.forEach(function(u){i[n+"["+r+"]."+u]=t[u]})}else i[n+"["+r+"]"]=t})}function s(n){if(n.errors){var t="";$.each(n.errors,function(){var n=this.replace("\\r\\n","\r\n");t+=n+"\n"});$("pre#err-message").text(t);$("div#err-window").data("kendoWindow").open()}}function h(n){var i=n.sender,t;n.errors?(t="",$.each(n.errors,function(n,i){"errors"in i&&$.each(i.errors,function(){var n=this.replace("\\r\\n","\r\n");t+=n+"\n"})}),$("pre#err-message").text(t),$("div#err-window").data("kendoWindow").open()):location.reload();i.cancelChanges()}function c(n){$(n).data("kendoWindow").close()}function n(n){var t=$(n).data("kendoGrid");t&&t.dataSource.read()}function l(n){var t=$(n).data("kendoGrid");t&&(t.dataSource.data([]),t.dataSource.read())}function a(n){var t=this.dataSource.options.transport.read.url.split("/"),i=t[t.length-1],r=this.dataSource.options.transport.read.url.replace(i,"ValueMapper");$.ajax({url:r,data:e(n.value),success:function(t){n.success(t)}})}function y(){for(var r,i,t=this.dataSource.view(),n=0;n<t.length;n++){let f=t[n].uid,u=this.table.find("tr[data-uid='"+f+"']");if(t[n].IsDeleted&&(r=$(u).find(".k-grid-edit,.k-grid-delete, .k-grid-lock, .k-grid-unlock"),r.attr("style","display:none !important"),i=$("#"+$(this.element).attr("id")+" tbody").find("tr[data-uid="+f+"] td"),i.addClass("text-danger"),i.find("a").addClass("text-warning")),t[n].IsLocked){u.addClass("text-white");u.addClass("bg-warning");u.find(".k-grid-lock").attr("disabled","disabled").addClass("k-state-disabled").on("click",function(){return!1})}else u.find(".k-grid-unlock").attr("disabled","disabled").addClass("k-state-disabled").on("click",function(){return!1})}}function p(t){t.type==="update"&&n("#grid")}function w(){var t=this.dataSource.view(),n=this;$.each(t,function(t,i){var r=i.uid;i.MessageType===1&&$("#"+$(n.element).attr("id")+" tbody").find("tr[data-uid="+r+"]").addClass("bg-info");i.MessageType===2&&$("#"+$(n.element).attr("id")+" tbody").find("tr[data-uid="+r+"]").addClass("bg-warning");i.MessageType===3&&$("#"+$(n.element).attr("id")+" tbody").find("tr[data-uid="+r+"]").addClass("bg-danger")})}function b(n){var i=this.dataSource.view(),t=n.sender.element;i.length>0&&$.each(i,function(n,i){var r=i.uid,e=t.find("tr[data-uid='"+r+"']"),u,f;i.IsDeleted?(u=$(e).find(".k-grid-edit"),typeof u!="undefined"&&u.attr("style","display:none !important"),f=$(e).find(".k-grid-delete"),typeof f!="undefined"&&f.attr("style","display:none !important"),t.find("tr[data-uid="+r+"]").addClass("bg-danger")):i.IsExpired&&t.find("tr[data-uid="+r+"]").addClass("bg-disabled")})}function k(n){var t,i;n.action==="add"&&(t=n.items[0],t!==null&&(i=$("input[name=date]").data("kendoDatePicker").value(),t.RecordTimestamp=i))}function d(n){var t,i;n.action==="itemchange"&&(t=n.items[0],t!==null&&(i=$("input[name=date]").data("kendoDatePicker").value(),t.RecordTimestamp=i))}function g(t){t.type==="destroy"&&(n("#inner-pipes"),n("#tanks-statuses"))}String.prototype.replaceAll=function(n,t){return this.split(n).join(t)};$(function(){var i=$("#culture").val(),n;if(kendo.culture(i),t("div#err-window","Възникна грешка в приложението"),t("div#success-window","Успешна операция"),n=$("#editor-save-changes"),n!==undefined&&n!==null){n.on("click",f);n.parent().css("float","right")}});var v=function(){var n={id:$("input[name=id]").val(),entityName:$("input[name=entityName]").val()};return $.extend(n,sendAntiForgery()),n};return{DisplayErrors:s,ErrorHandler:h,CloseWindow:c,RefreshGrid:n,ValueMapper:a,SendHistoryData:v,DeletableDataBound:y,AfterterNomGridValidation:p,MessageBound:w,MessagesDataBound:b,OnChange:k,OnPipeChange:d,OnRequestEnd:g,ReportDetailsPaste:r,FullyRefreshGrid:l}}();